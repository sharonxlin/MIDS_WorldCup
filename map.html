<!DOCTYPE html>
<meta charset="utf-8">
 <head>
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Lato">
  </head>
<style>
body { 
  color: #FFFFFF; 
  font: normal 10px "Lato", sans-serif; 
  margin: 2em; 
}
#map {
  border:2px solid #000;
  width:960px;
  height:550px;
  background: #EEEEEE;
}

#slider-range {
  border:2px solid #000;
  width:960px;
  background: #EEEEEE;
}

#time {
  font: normal 20px "Lato", Helvetica, sans-serif; 
}

.country {
  fill: #ccc;
  stroke: #fff;
  stroke-width: .5px;
  stroke-linejoin: round;
}

.hidden { 
  display: none; 
}

div.tooltip {
  color: #222; 
  background: #fff; 
  padding: .5em; 
  text-shadow: #f5f5f5 0 1px 0;
  border-radius: 2px; 
  box-shadow: 0px 0px 2px 0px #a6a6a6; 
  opacity: 0.9; 
  position: absolute;
}

.team1style {
  width: 300px;
  display: inline-block;
  text-align: right;
  padding-right: 10px;
}

.team2style {
  width: 300px;
  display: inline-block;
  text-align: left;
  padding-left: 10px;
}

.scorestyle {
  padding-right: 10px;
  padding-left: 10px;
}

#matches {
  width: 960px;
  height: 200px;
  font: normal 35px "Lato", Helvetica, sans-serif;
  text-align: center;
}

</style>
<link rel="stylesheet" type="text/css" href="map_js/jquery-ui-1.11.0.custom/jquery-ui.min.css">
<body>
<div id="map"></div>
<br/><br/>
<div id="slider-range"></div>
<br/>
<div id="time"></div>
<br/>
<div id="matches">
  <div id="match0">
    <span>June 12  </span><br/>
    <span class="team1style">Brazil    </span><img src="images/flags/bra.png"/><span class="scorestyle">3-1</span><img src="images/flags/cro.png"/><span class="team2style"> Croatia    </span><br/>
  </div>
  <div id="match1">
   <span>June 13  </span><br/>
   <span class="team1style">Mexico    </span><img src="images/flags/mex.png"/><span class="scorestyle">1-0</span><img src="images/flags/cmr.png"/><span class="team2style"> Cameroon   </span><br/>
   <span class="team1style">Spain     </span><img src="images/flags/esp.png"/><span class="scorestyle">1-5</span><img src="images/flags/ned.png"/><span class="team2style"> Netherlands  </span><br/>
   <span class="team1style">Chile     </span><img src="images/flags/chi.png"/><span class="scorestyle">3-1</span><img src="images/flags/aus.png"/><span class="team2style"> Australia  </span><br/>  
  </div>
  <div id="match2">
    <span>June 14  </span><br/>
    <span class="team1style">Colombia    </span><img src="images/flags/col.png"/><span class="scorestyle">3-0</span><img src="images/flags/gre.png"/><span class="team2style"> Greece   </span><br/>
    <span class="team1style">Uruguay     </span><img src="images/flags/uru.png"/><span class="scorestyle">1-3</span><img src="images/flags/crc.png"/><span class="team2style"> Costa Rica </span><br/>
    <span class="team1style">England     </span><img src="images/flags/eng.png"/><span class="scorestyle">1-2</span><img src="images/flags/ita.png"/><span class="team2style"> Italy    </span><br/>
    <span class="team1style">Ivory Coast </span><img src="images/flags/civ.png"/><span class="scorestyle">2-1</span><img src="images/flags/jpn.png"/><span class="team2style"> Japan    </span><br/>
  </div>
  <div id="match3">
    <span>June 15  </span><br/>
    <span class="team1style">Switzerland </span><img src="images/flags/sui.png"/><span class="scorestyle">2-1</span><img src="images/flags/ecu.png"/><span class="team2style"> Ecuador    </span><br/>
    <span class="team1style">France      </span><img src="images/flags/fra.png"/><span class="scorestyle">3-0</span><img src="images/flags/hon.png"/><span class="team2style"> Honduras   </span><br/>
    <span class="team1style">Argentina   </span><img src="images/flags/arg.png"/><span class="scorestyle">2-1</span><img src="images/flags/bih.png"/><span class="team2style"> Bosnia-H.  </span><br/>
  </div>
  <div id="match4">
    <span>June 16  </span><br/>
    <span class="team1style">Germany   </span><img src="images/flags/ger.png"/><span class="scorestyle">4-0</span><img src="images/flags/por.png"/><span class="team2style"> Portugal   </span><br/>
    <span class="team1style">Iran      </span><img src="images/flags/irn.png"/><span class="scorestyle">0-0</span><img src="images/flags/nga.png"/><span class="team2style"> Nigeria    </span><br/>
    <span class="team1style">Ghana     </span><img src="images/flags/gha.png"/><span class="scorestyle">1-2</span><img src="images/flags/usa.png"/><span class="team2style"> USA      </span><br/>
  </div>
  <div id="match5">
    <span>June 17  </span><br/>
    <span class="team1style">Belgium   </span><img src="images/flags/bel.png"/><span class="scorestyle">2-1</span><img src="images/flags/alg.png"/><span class="team2style"> Algeria    </span><br/>
    <span class="team1style">Brazil    </span><img src="images/flags/bra.png"/><span class="scorestyle">0-0</span><img src="images/flags/mex.png"/><span class="team2style"> Mexico   </span><br/>
    <span class="team1style">Russia    </span><img src="images/flags/rus.png"/><span class="scorestyle">1-1</span><img src="images/flags/kor.png"/><span class="team2style"> South Korea  </span><br/>
  </div>
  <div id="match6">
    <span>June 18  </span><br/>
    <span class="team1style">Australia </span><img src="images/flags/aus.png"/><span class="scorestyle">2-3</span><img src="images/flags/ned.png"/><span class="team2style"> Netherlands  </span><br/>
    <span class="team1style">Spain     </span><img src="images/flags/esp.png"/><span class="scorestyle">0-2</span><img src="images/flags/chi.png"/><span class="team2style"> Chile    </span><br/>
    <span class="team1style">Cameroon  </span><img src="images/flags/cmr.png"/><span class="scorestyle">0-4</span><img src="images/flags/cro.png"/><span class="team2style"> Croatia    </span><br/>
  </div>
  <div id="match7">
    <span>June 19  </span><br/>
    <span class="team1style">Colombia  </span><img src="images/flags/col.png"/><span class="scorestyle">2-1</span><img src="images/flags/civ.png"/><span class="team2style"> Ivory Coast  </span><br/>
    <span class="team1style">Uruguay   </span><img src="images/flags/uru.png"/><span class="scorestyle">2-1</span><img src="images/flags/eng.png"/><span class="team2style"> England    </span><br/>
    <span class="team1style">Japan     </span><img src="images/flags/jpn.png"/><span class="scorestyle">0-0</span><img src="images/flags/gre.png"/><span class="team2style"> Greece   </span><br/>
  </div>
  <div id="match8">
    <span>June 20  </span><br/>
    <span class="team1style">Italy       </span><img src="images/flags/ita.png"/><span class="scorestyle">0-1</span><img src="images/flags/crc.png"/><span class="team2style"> Costa Rica </span><br/>
    <span class="team1style">Switzerland </span><img src="images/flags/sui.png"/><span class="scorestyle">2-5</span><img src="images/flags/fra.png"/><span class="team2style"> France   </span><br/>
    <span class="team1style">Honduras    </span><img src="images/flags/hon.png"/><span class="scorestyle">1-2</span><img src="images/flags/ecu.png"/><span class="team2style"> Ecuador    </span><br/>
  </div>
  <div id="match9">
    <span>June 21  </span><br/>
    <span class="team1style">Argentina   </span><img src="images/flags/arg.png"/><span class="scorestyle">1-0</span><img src="images/flags/irn.png"/><span class="team2style"> Iran     </span><br/>
    <span class="team1style">Germany     </span><img src="images/flags/ger.png"/><span class="scorestyle">2-2</span><img src="images/flags/gha.png"/><span class="team2style"> Ghana    </span><br/>
    <span class="team1style">Nigeria     </span><img src="images/flags/nga.png"/><span class="scorestyle">1-0</span><img src="images/flags/bih.png"/><span class="team2style"> Bosnia-H.  </span><br/>
  </div>
  <div id="match10">
    <span>June 22  </span><br/>
    <span class="team1style">Belgium      </span><img src="images/flags/bel.png"/><span class="scorestyle">1-0</span><img src="images/flags/rus.png"/><span class="team2style"> Russia   </span><br/>
    <span class="team1style">South Korea  </span><img src="images/flags/kor.png"/><span class="scorestyle">2-4</span><img src="images/flags/alg.png"/><span class="team2style"> Algeria    </span><br/>
    <span class="team1style">USA          </span><img src="images/flags/usa.png"/><span class="scorestyle">2-2</span><img src="images/flags/por.png"/><span class="team2style"> Portugal   </span><br/>
  </div>
  <div id="match11">
    <span>June 23  </span><br/>
    <span class="team1style">Netherlands </span><img src="images/flags/ned.png"/><span class="scorestyle">2-0</span><img src="images/flags/chi.png"/><span class="team2style"> Chile    </span><br/>
    <span class="team1style">Australia   </span><img src="images/flags/aus.png"/><span class="scorestyle">0-3</span><img src="images/flags/esp.png"/><span class="team2style"> Spain    </span><br/>
    <span class="team1style">Cameroon    </span><img src="images/flags/cmr.png"/><span class="scorestyle">1-4</span><img src="images/flags/bra.png"/><span class="team2style"> Brazil   </span><br/>
    <span class="team1style">Croatia     </span><img src="images/flags/cro.png"/><span class="scorestyle">1-3</span><img src="images/flags/mex.png"/><span class="team2style"> Mexico   </span><br/>
  </div>
  <div id="match12">
    <span>June 24  </span><br/>
    <span class="team1style">Italy       </span><img src="images/flags/ita.png"/><span class="scorestyle">0-1</span><img src="images/flags/uru.png"/><span class="team2style"> Uruguay    </span><br/>
    <span class="team1style">Costa Rica  </span><img src="images/flags/crc.png"/><span class="scorestyle">0-0</span><img src="images/flags/eng.png"/><span class="team2style"> England    </span><br/>
    <span class="team1style">Japan       </span><img src="images/flags/jpn.png"/><span class="scorestyle">1-4</span><img src="images/flags/col.png"/><span class="team2style"> Colombia   </span><br/>  
    <span class="team1style">Greece      </span><img src="images/flags/gre.png"/><span class="scorestyle">2-1</span><img src="images/flags/civ.png"/><span class="team2style"> Ivory Coast  </span><br/>
  </div>
  <div id="match13">
    <span>June 25  </span><br/>
    <span class="team1style">Nigeria     </span><img src="images/flags/nga.png"/><span class="scorestyle">2-3</span><img src="images/flags/arg.png"/><span class="team2style"> Argentina  </span><br/>
    <span class="team1style">Bosnia-H.   </span><img src="images/flags/bih.png"/><span class="scorestyle">3-1</span><img src="images/flags/irn.png"/><span class="team2style"> Iran     </span><br/>
    <span class="team1style">Honduras    </span><img src="images/flags/hon.png"/><span class="scorestyle">0-3</span><img src="images/flags/sui.png"/><span class="team2style"> Switzerland  </span><br/>
    <span class="team1style">Ecuador     </span><img src="images/flags/ecu.png"/><span class="scorestyle">0-0</span><img src="images/flags/fra.png"/><span class="team2style"> France   </span><br/>
  </div>
  <div id="match14">
    <span>June 26  </span><br/>
    <span class="team1style">Portugal      </span><img src="images/flags/por.png"/><span class="scorestyle">2-1</span><img src="images/flags/gha.png"/><span class="team2style"> Ghana    </span><br/>
    <span class="team1style">United States </span><img src="images/flags/usa.png"/><span class="scorestyle">0-1</span><img src="images/flags/ger.png"/><span class="team2style"> Germany    </span><br/>
    <span class="team1style">South Korea   </span><img src="images/flags/kor.png"/><span class="scorestyle">0-1</span><img src="images/flags/bel.png"/><span class="team2style"> Belgium    </span><br/>
    <span class="team1style">Algeria       </span><img src="images/flags/alg.png"/><span class="scorestyle">1-1</span><img src="images/flags/rus.png"/><span class="team2style"> Russia   </span><br/>
  </div>
  <div id="match15">
    <span>June 27  </span><br/>
  </div>
  <div id="match16">
    <span>June 28  </span><br/>
    <span class="team1style">Brazil    </span><img src="images/flags/bra.png"/><span class="scorestyle">1-1</span><img src="images/flags/chi.png"/><span class="team2style"> Chile    </span><br/>
    <span class="team1style">Colombia  </span><img src="images/flags/col.png"/><span class="scorestyle">2-0</span><img src="images/flags/uru.png"/><span class="team2style"> Uruguay    </span><br/>
  </div>
  <div id="match17">
    <span>June 29  </span><br/>
    <span class="team1style">Netherlands </span><img src="images/flags/ned.png"/><span class="scorestyle">2-1</span><img src="images/flags/mex.png"/><span class="team2style"> Mexico   </span><br/>
    <span class="team1style">Costa Rica  </span><img src="images/flags/crc.png"/><span class="scorestyle">1-1</span><img src="images/flags/gre.png"/><span class="team2style"> Greece   </span><br/>
  </div>
  <div id="match18">
    <span>June 30  </span><br/>
    <span class="team1style">France    </span><img src="images/flags/fra.png"/><span class="scorestyle">2-0</span><img src="images/flags/nga.png"/><span class="team2style"> Nigeria    </span><br/>
    <span class="team1style">Germany   </span><img src="images/flags/ger.png"/><span class="scorestyle">2-1</span><img src="images/flags/alg.png"/><span class="team2style"> Algeria    </span><br/>
  </div>
  <div id="match19">
    <span>July 01  </span><br/>
    <span class="team1style">Argentina   </span><img src="images/flags/arg.png"/><span class="scorestyle">1-0</span><img src="images/flags/sui.png"/><span class="team2style"> Switzerland  </span><br/>
    <span class="team1style">Belgium     </span><img src="images/flags/bel.png"/><span class="scorestyle">2-1</span><img src="images/flags/usa.png"/><span class="team2style"> USA      </span><br/>
  </div>
  <div id="match20">
    <span>July 02  </span><br/>
  </div>
  <div id="match21">
    <span>July 03  </span><br/>
  </div>
  <div id="match22">
    <span>July 04  </span><br/>
    <span class="team1style">France    </span><img src="images/flags/fra.png"/><span class="scorestyle">0-1</span><img src="images/flags/ger.png"/><span class="team2style"> Germany    </span><br/>
    <span class="team1style">Brazil    </span><img src="images/flags/bra.png"/><span class="scorestyle">2-1</span><img src="images/flags/col.png"/><span class="team2style"> Colombia   </span><br/>
  </div>
  <div id="match23">
    <span>July 05  </span><br/>
    <span class="team1style">Argentina   </span><img src="images/flags/arg.png"/><span class="scorestyle">1-0</span><img src="images/flags/bel.png"/><span class="team2style"> Belgium    </span><br/>
    <span class="team1style">Netherlands </span><img src="images/flags/ned.png"/><span class="scorestyle">0-0</span><img src="images/flags/crc.png"/><span class="team2style"> Costa Rica </span><br/>
  </div>
  <div id="match24">
    <span>July 06  </span><br/>
  </div>
  <div id="match25">
    <span>July 07  </span><br/>
  </div>
  <div id="match26">
    <span>July 08  </span><br/>
    <span class="team1style">Brazil    </span><img src="images/flags/bra.png"/><span class="scorestyle">1-7</span><img src="images/flags/ger.png"/><span class="team2style"> Germany    </span><br/>
  </div>
  <div id="match27">
    <span>July 09  </span><br/>
    <span class="team1style">Netherlands </span><img src="images/flags/ned.png"/><span class="scorestyle">0-0</span><img src="images/flags/arg.png"/><span class="team2style"> Argentina  </span><br/>
  </div>
  <div id="match28">
    <span>July 10  </span><br/>
  </div>
  <div id="match29">
    <span>July 11  </span><br/>
  </div>
  <div id="match30">
    <span>July 12  </span><br/>
    <span class="team1style">Brazil    </span><img src="images/flags/bra.png"/><span class="scorestyle">0-3</span><img src="images/flags/ned.png"/><span class="team2style"> Netherlands  </span><br/>
  </div>
  <div id="match31">
    <span>July 13  </span><br/>
    <span class="team1style">Germany   </span><img src="images/flags/ger.png"/><span class="scorestyle">1-0</span><img src="images/flags/arg.png"/><span class="team2style"> Argentina  </span><br/>
  </div>
</div>
<br/><br/>



<script src="map_js/jquery-2.1.1.min.js"></script>
<script src="map_js/jquery-ui-1.11.0.custom/jquery-ui.min.js"></script>
<script type="text/javascript">
    $("#slider-range").slider({
        range: false,
        min: 0,
        max: 46079,
        values: [0],
        slide: slideTime
    });

    function slideTime(event, ui){
        var val0 = $("#slider-range").slider("values", 0),
            minutes0 = parseInt(val0 % 60, 10),
            hours0 = parseInt(val0 / 60 % 24, 10),
            day0 = parseInt(val0 / 60 / 24 % 32, 10);
        startTime = getTime(day0, hours0, minutes0);
        $("#time").text(startTime);
        $('#matches div').hide();
        $('#matches #match' + day0).show();
    }
    function getTime(days, hours, minutes) {
        var time = null;
        minutes = minutes + "";
        days = days + 1 + "";
        if (hours < 12) {
            time = "AM";
        }
        else {
            time = "PM";
        }
        if (hours == 0) {
            hours = 12;
        }
        if (hours > 12) {
            hours = hours - 12;
        }
        if (minutes.length == 1) {
            minutes = "0" + minutes;
        }
        return "Day " + days;
        // + " " + hours + ":" + minutes + " " + time;
    }
    slideTime();
</script>

<script src="map_js/d3.js"></script>
<script src="map_js/queue.js"></script>
<script src="map_js/topojson.js"></script>
<script>
// The SVG container
var width  = 960,
    height = 550;

var color = d3.scale.category10();

var projection = d3.geo.mercator()
                .translate([480, 300])
                .scale(140);

var path = d3.geo.path()
    .projection(projection);

var svg = d3.select("#map").append("svg")
    .attr("width", width)
    .attr("height", height);

var tooltip = d3.select("#map").append("div")
    .attr("class", "tooltip hidden");

queue()
    .defer(d3.json, "map_js/world-110m.json")
    .defer(d3.tsv, "map_js/world-country-names.tsv")
    .await(ready);

function ready(error, world, names) {
  if (typeof drawgraph === 'undefined'){
    setTimeout(function(){ready(error,world,names);}, 500);
  } else {
    draw_map(world, names);
    drawgraph();
  }
}

function draw_map(world, names) {

  var countries = topojson.object(world, world.objects.countries).geometries,
      neighbors = topojson.neighbors(world, countries),
      i = -1,
      n = countries.length;

  countries.forEach(function(d) { 
    d.name = names.filter(function(n) { return d.id == n.id; })[0].name; 
  });

var country = svg.selectAll(".country").data(countries);

  country
   .enter()
    .insert("path")
    .attr("class", "country")    
      .attr("title", function(d,i) { return d.name; })
      .attr("d", path)
      //.style("fill", function(d, i) { return color(d.color = d3.max(neighbors[i], function(n) { return countries[n].color; }) + 1 | 0); })
      .style("fill", "#FDB515");

    //Show/hide tooltip
    country
      .on("mousemove", function(d,i) {
        var mouse = d3.mouse(svg.node()).map( function(d) { return parseInt(d); } );

        tooltip
          .classed("hidden", false)
          .attr("style", "left:"+(mouse[0]+25)+"px;top:"+(mouse[1]+30)+"px")
          .html(d.name)
      })
      .on("mouseout",  function(d,i) {
        tooltip.classed("hidden", true)
      });

}
</script>

<script src="map_js/places.js"></script>

<script>
function converttime(time){
  var d = new Date(time);
  var converted_date = d.getUTCDate(time);
  var converted_mon = d.getUTCMonth(time)+1;
  if (converted_mon == 6){
    var converted_day = converted_date-11;
  } else {
    var converted_day = converted_date+19;
  }
  return converted_day;
}

function getpointsforday(day){
  var subset = [];
  for (i=0; i < places.length; i++){
    if (converttime(places[i].time) == day){
      subset.push(places[i]);
    }
  }
  return subset;
}

function plotpoints (subset){
  svg.selectAll(".pin")
  .data(subset)
  .enter().append("circle", ".pin")
  .attr("r", function(d){return Math.log(d.count);})
  .attr("transform", function(d) {
    return "translate(" + projection([
      d.location.longitude,
      d.location.latitude
    ]) + ")"
  })
  .style("fill", "#003262")
  .style("fill-opacity", 0.35)
  // .style("stroke", "#003262")
  // .style("stroke-width", "0.5px")
  .style("stroke-opacity", 1);
}

function removepoints(){
  var circles = svg.selectAll('circle')[0];
  for (i = 0; i < circles.length; i ++){
    circles[i].remove();
  }
}

function drawgraph(){    
  removepoints();
  var slider_value = $("#slider-range").slider("values", 0);
  var day = parseInt(slider_value / 60 / 24 % 32, 10)+1;
  var subset = getpointsforday(day);
  plotpoints(subset);
}

function drawslide(slider_value){
  removepoints();
  var day = parseInt(slider_value / 60 / 24 % 32, 10)+1;
  var subset = getpointsforday(day);
  plotpoints(subset);
}
  
  $("#slider-range").on( "slidechange", function( event, ui ) {drawgraph();} );
  $("#slider-range").on( "slide", function( event, ui ) {drawslide(ui.value);} );


</script>


